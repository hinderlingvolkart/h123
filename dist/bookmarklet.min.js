"use strict";function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){a=!0,r=e},f:function(){try{l||null==i.return||i.return()}finally{if(a)throw r}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}var containerId="a11y-bookmarklet",containerStyle="position: fixed; top: 0; right: 0; max-height: 100%; box-shadow: 0 0 80px rgba(0,0,0,0.3); width: 20%; min-width: 320px; max-width: 450px; z-index: 1000001;",highlighterEl=document.createElement("DIV");highlighterEl.id="h1-a11y-highlighterelement",highlighterEl.style.cssText="pointer-events: none; position: fixed; border: 1px dashed #0081BE; box-shadow: 0 0 54px 0 rgba(0,84,150,0.3); display: none; z-index: 1000000; transition: all 200ms;";var container=document.getElementById(containerId);container&&document.body.removeChild(container),(container=document.createElement("DIV")).id=containerId,container.style.cssText=containerStyle;var iframe=document.createElement("IFRAME");iframe.style.width="100%",iframe.style.height="100%",iframe.style.borderWidth="0";var doc,outline=getOutline();function updateHeight(){container&&(container.style.height="0px",container.style.height=doc.scrollingElement.scrollHeight+"px")}function getOutline(){for(var e=0,t=customQuerySelectorAll(document,':is(h1,h2,h3,h4,h5,h6,h7,[role="heading"]):not([role="presentation"])'),i=[],n=0;n<t.length;n++){var o=t[n],r=isVisible(t[n]),l=o.getAttribute("aria-level"),a=parseInt(l||o.nodeName.charAt(1)),d=!1;r&&(d=a>e&&a!==e+1,0===e&&(d=a>2),e=a),i.push({visible:r,visuallyhidden:r&&isVisuallyHidden(o),wrong:d,level:a,el:o})}return i}function countOutline(e,t){for(var i=0,n=0;n<e.length;n++)e[n][t]&&i++;return i}function outlineToHTML(e){for(var t="",i=0;i<e.length;i++){var n=e[i],o=n.el;t+='<li class="',t+=n.wrong?"wrong-level":"correct-level",t+=n.visible?"":" hidden",t+=n.visuallyhidden?" visuallyhidden":"",t+='" style="margin-left: '+n.level+'em;">',t+='<a href="#'+i+'" target="_top">',t+='<span class="level" data-level="'+n.level+'"></span> ',t+='<span class="text">'+htmlEntities(textContent(o).replace(/\s+/g," "))+"</span>",t+="</a>",t+="</li>"}return'<ul id="headings">'+t+"</ul>"}function htmlEntities(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function isVisible(e){for(var t=window.getComputedStyle(e),i=!1,n=e;n;){if("none"===t.display)return!1;if(!i){if("hidden"===t.visibility)return!1;"visible"===t.visibility&&(i=!0)}if("true"===n.getAttribute("aria-hidden"))return!1;var o=n.assignedSlot||n;n=o.parentElement||o.getRootNode().host;try{t=window.getComputedStyle(n)}catch(e){return!0}}return!0}function isVisuallyHidden(e){var t=e.getBoundingClientRect();if("absolute"===window.getComputedStyle(e).position){if(t.width<=1&&t.height<=1)return!0;if(t.right<=0)return!0}return!1}function highlightElement(e,t){t||(e.scrollIntoViewIfNeeded?e.scrollIntoViewIfNeeded():e.scrollIntoView&&e.scrollIntoView()),setTimeout((function(){for(var t=e.getBoundingClientRect(),i=e.parentElement;!t.height&&!t.width&&!t.left&&!t.top&&i;)t=i.getBoundingClientRect(),i=i.parentElement;if(i){var n=Math.min(window.innerWidth,t.left),o=Math.max(0,t.right),r=Math.min(window.innerHeight,t.top),l=Math.max(0,t.bottom);document.getElementById(highlighterEl.id)||document.body.appendChild(highlighterEl),highlighterEl.style.left=n-10+"px",highlighterEl.style.width=o-n+20+"px",highlighterEl.style.top=r-10+"px",highlighterEl.style.height=l-r+20+"px",highlighterEl.style.display="block"}}),100)}function handleHoverHighlight(e){var t=function(){e.checked?enableHoverHighlight():disableHoverHighlight()};t(),e.addEventListener("click",t)}function highlightLink(e){for(var t=doc.querySelectorAll("#headings a"),i=t.length-1;i>=0;i--)t[i]===e?t[i].classList.add("is-active"):t[i].classList.remove("is-active")}function handleElementHover(e){for(var t=e.target,i=document.body.querySelectorAll("*"),n=!1,o=i.length-1;o>=0;o--){var r=i[o];if(n){for(var l=outline.length-1;l>=0;l--)if(outline[l].el===r&&outline[l].visible)return highlightElement(outline[l].el,!0),void highlightLink(doc.querySelector('#headings a[href="#'+l+'"]'))}else r===t&&(n=!0,o++)}highlightLink(null)}function enableHoverHighlight(){document.body.addEventListener("mouseover",handleElementHover)}function disableHoverHighlight(){document.body.removeEventListener("mouseover",handleElementHover)}function customQuerySelectorAll(e,t){for(var i,n=[],o=document.createNodeIterator(e,Node.ELEMENT_NODE);i=o.nextNode();){var r=i;r.matches(t)?n.push(r):r.shadowRoot&&n.push.apply(n,_toConsumableArray(customQuerySelectorAll(r.shadowRoot,t)))}return n}function textContent(e){for(var t=[e.textContent||""],i=e.querySelectorAll("slot"),n=0;n<i.length;n++){var o,r=_createForOfIteratorHelper(i[n].assignedNodes());try{for(r.s();!(o=r.n()).done;){var l=o.value;t.push(l.textContent||"")}}catch(e){r.e(e)}finally{r.f()}}return t.filter(Boolean).join(" ")}container.appendChild(iframe),iframe.onload=function(){iframe.onload=function(){},(doc=iframe.contentWindow.document).open(),doc.write('<html> <head> <meta name="viewport" content="width=device-width,minimum-scale=1.0,initial-scale=1,user-scalable=yes"> <style> * { margin: 0; padding: 0; border: 0; } body { font: 14px/1.6 sans; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; color: #284900; background: rgba(255,255,255,0.95); white-space: nowrap; overflow-x: hidden; text-overflow: ellipsis; padding: 15px; padding-bottom: 30px; } ul { margin: 0 0 0 -10px; padding: 0; } li { color: #284900; list-style: none; margin-left: 20px; display: -webkit-flex; display: flex; } a { color: inherit; text-decoration: none; display: inline-block; max-width: 30em; overflow: hidden; text-overflow: ellipsis; padding: 2px 4px 2px 25px; position: relative; line-height: 1.3; border-radius: 3px; } a > .level { display: inline-block; background-color: currentColor; font-size: 85%; font-weight: bold; width: 2.7ex; height: 2.7ex; text-align: center; box-sizing: border-box; position: absolute; left: 2px; top: 2px; padding-top: 1px; } a > .level:before { content: attr(data-level); color: white; } li.hidden { color: black; text-decoration: line-through; opacity: 0.5; } .result:not(.show-hidden) li.hidden { display: none; } .result.mark-visuallyhidden li.visuallyhidden .level:before { color: inherit; } .result.mark-visuallyhidden li.visuallyhidden .level { border: 1px dashed; background: white; } li.wrong-level { color: #AF3A37; } a.is-active { box-shadow: 0 0 5px 1px #3CBEFF; } a:hover { background-color: currentColor; } a:hover > .text { color: white; } a:hover > .level { background-color: transparent; } header { padding-top: 5px; padding-bottom: 15px; padding-right: 5em; margin-bottom: 1em; border-bottom: 1px solid #eee; } legend { margin-right: 1em; font-weight: bold; } @media (min-width: 340px) { legend { float: left; } } .options { display: -webkit-flex; display: flex; -webkit-flex-wrap: wrap; flex-wrap: wrap; } .options .input { margin-right: 2em; } .count { background: #ddd; border-radius: 4px; padding: 1px 3px; } .tooltip { position: relative; } .tooltip:before { content: \'ℹ️\'; } .tooltip:focus:after, .tooltip:hover:after { content: attr(title); position: absolute; background: white; padding: 4px 10px; top: 70%; left: 70%; width: 10em; box-shadow: 0 2px 20px rgba(0,0,0,0.3); white-space: normal; border-radius: 8px; border-top-left-radius: 0; z-index: 1; pointer-events: none; } .button-close { position: absolute; top: 15px; right: 15px; padding: 5px 10px; border-radius: 5px; border: 0; font-size: inherit; color: white; background-color: #284900; cursor: pointer; } .button-close:hover { color: white; background-color: #284900; } </style> </head> <body> <header> <button class="button-close" data-action="close">Close</button> <fieldset> <legend>Options</legend> <div class="options"> <div class="input"> <input type="checkbox" name="options" id="o-hidden"> <label for="o-hidden">Show hidden <span class="count" id="o-hidden-count"></span> <span class="tooltip" title="also hidden for screenreaders" tabindex="0"></span></label> </div> <div class="input"> <input type="checkbox" name="options" id="o-visuallyhidden"> <label for="o-visuallyhidden">Mark visually hidden <span class="count" id="o-visuallyhidden-count"></span> <span class="tooltip" title="only visible for screenreaders" tabindex="0"></span></label> </div> <div class="input"> <input type="checkbox" name="options" id="o-highlight"> <label for="o-highlight">Hover-Highlight <span class="tooltip" title="Highlight the corresponding heading when hovering over elements of the page" tabindex="0"></span></label> </div> </div> </fieldset> </header> <main id="result" class="result"> </main> </body> </html> '),doc.close();var e=doc.querySelector('[data-action="close"]');e&&e.addEventListener("click",(function(e){disableHoverHighlight(),window.removeEventListener("resize",updateHeight),document.body.removeChild(container),document.getElementById(highlighterEl.id)&&document.body.removeChild(highlighterEl)}));var t=doc.querySelector("#result");function i(e,t){var i=doc.getElementById(e),n=doc.querySelector(".result");if(i&&n){var o=function(e){i.checked?n.classList.add(t):n.classList.remove(t),e&&updateHeight()};i.addEventListener("change",o,!1),i.addEventListener("click",o,!1),o()}}t&&(t.innerHTML=outlineToHTML(outline)),(t=doc.querySelector("#o-hidden-count"))&&(t.innerText=(outline.length-countOutline(outline,"visible")).toString()),(t=doc.querySelector("#o-visuallyhidden-count"))&&(t.innerText=countOutline(outline,"visuallyhidden").toString()),i("o-hidden","show-hidden"),i("o-visuallyhidden","mark-visuallyhidden"),handleHoverHighlight(doc.getElementById("o-highlight")),updateHeight(),doc.addEventListener("mouseover",(function(e){var t=null,i=e.target;if("A"===i.nodeName.toUpperCase()?t=i:i.parentElement&&"A"===i.parentElement.nodeName.toUpperCase()&&(t=i.parentElement),t){var n=t.getAttribute("href");if(n){var o=parseInt(n.substr(1),10);highlightElement(outline[o].el)}}}),!1),window.addEventListener("resize",updateHeight)},document.body.appendChild(container);